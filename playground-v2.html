<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playground - V2</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Outfit:wght@400;500&family=Roboto:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="theme.js"></script>
</head>

<body>

    <div class="container">
        <!-- Header -->
        <header>
            <a href="index-v2.html" class="logo">James Hou</a>
            <nav>
                <a href="about-v2.html">About</a>
                <a href="playground-v2.html" class="active">Playground</a>
            </nav>
        </header>

        <div class="playground-layout-v2">
            <!-- Intro Section -->
            <div class="playground-intro">
                <p class="playground-description">A space for experiments, side projects, and creative explorations.
                    Here you'll find tools I've built, music I've created, and thoughts I've written down along the way.
                </p>
            </div>

            <!-- Row 1: App Showcase + Music -->
            <div class="playground-row">
                <!-- Featured Tool (Large) -->
                <div class="playground-card large"
                    style="display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; overflow: hidden;">
                    <span class="chip chip-ai">AI Tool</span>
                    <div class="card-content" style="padding: 40px; text-align: center; z-index: 2;">
                        <h2 style="font-size: 32px; font-weight: 500; margin: 0 0 10px 0; color: var(--text-primary);">
                            Color Generator</h2>
                        <p style="color: var(--text-p-grey); margin-bottom: 30px; font-size: 16px;">A simple tool
                            generated entirely by Gemini to create random color palettes.</p>
                        <a href="apps/color-generator/index.html" target="_blank" class="btn-primary">Try it Out ↗</a>
                    </div>
                </div>

                <!-- Music Player with Playlist -->
                <div class="playground-card music-player-card" style="overflow: hidden;">
                    <div class="custom-audio-player">
                        <!-- Audio Visualization Canvas -->
                        <canvas id="audioVisualizer" class="audio-visualizer-canvas"></canvas>
                        <span class="chip chip-music">Music</span>

                        <!-- Main Player Layout -->
                        <div class="player-layout">
                            <!-- Current Track Info + Controls (Left) -->
                            <div class="player-main">
                                <div class="player-info">
                                    <h3 class="song-title">Luv & Experience</h3>
                                    <p class="artist-name">James Hou • Nujabes Beat</p>
                                </div>
                                <div class="player-controls">
                                    <!-- Prev Button -->
                                    <button class="btn-control" id="prevBtn">
                                        <svg viewBox="0 0 24 24">
                                            <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z" />
                                        </svg>
                                    </button>

                                    <!-- Play Button -->
                                    <button class="play-btn" id="playBtn">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path d="M8 5V19L19 12L8 5Z" fill="black" />
                                        </svg>
                                    </button>

                                    <!-- Next Button -->
                                    <button class="btn-control" id="nextBtn">
                                        <svg viewBox="0 0 24 24">
                                            <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z" />
                                        </svg>
                                    </button>

                                    <div class="progress-container" style="margin-left: 12px;">
                                        <div class="progress-bar"></div>
                                    </div>
                                    <span class="time-stamp" id="timeDisplay">0:00</span>
                                </div>
                            </div>

                            <!-- Playlist Panel (Right) -->
                            <div class="playlist-panel">
                                <div class="playlist-header">
                                    <span class="playlist-title">Playlist</span>
                                    <span class="playlist-count">1 track</span>
                                </div>
                                <ul class="playlist-items" id="playlistItems">
                                    <!-- Populated by JavaScript -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 2: Blog + Others -->
            <div class="playground-row">
                <!-- Blog Post (Small) -->
                <a href="posts/welcome.html" class="playground-card small"
                    style="width: 384px; text-decoration: none; display: block; transition: box-shadow 0.2s; overflow: hidden; position: relative;">
                    <span class="chip chip-life">Life</span>
                    <div
                        style="padding: 24px; padding-top: 56px; height: 100%; display: flex; flex-direction: column; justify-content: space-between;">
                        <div>
                            <h3
                                style="font-size: 20px; font-weight: 500; margin: 0 0 12px 0; color: var(--text-primary);">
                                Welcome to my Playground</h3>
                            <p style="font-size: 14px; color: var(--text-p-grey); line-height: 1.5;">A space for my
                                experiments, thoughts, and "plays" during life.</p>
                        </div>
                        <span style="font-size: 14px; font-weight: 500; color: var(--text-primary);">Read More →</span>
                    </div>
                </a>

                <!-- Placeholder 1 (Small) -->
                <div class="playground-card small"
                    style="width: 384px; display: flex; align-items: center; justify-content: center;">
                    <span style="color: var(--text-secondary);">More Coming Soon</span>
                </div>

                <!-- Placeholder 2 (Small) -->
                <div class="playground-card small"
                    style="width: 384px; display: flex; align-items: center; justify-content: center;">
                    <span style="color: var(--text-secondary);">More Coming Soon</span>
                </div>
            </div>
        </div>

        <footer>
            <div class="copyright">© 2026 James Hou</div>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/jameshouux/" target="_blank" rel="noopener noreferrer">Linkedin</a>
                <button class="email-copy-btn" id="emailCopyBtn">Email</button>
            </div>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div class="toast-container">
        <div class="toast" id="toast">
            <svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                    clip-rule="evenodd" />
            </svg>
            <span class="toast-message">Email copied to clipboard</span>
        </div>
    </div>

    <script>
        // Email copy to clipboard functionality
        document.getElementById('emailCopyBtn').addEventListener('click', function () {
            const email = 'j7supreme@gmail.com';
            navigator.clipboard.writeText(email).then(function () {
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(function () {
                    toast.classList.remove('show');
                }, 3000);
            }).catch(function (err) {
                console.error('Failed to copy email: ', err);
            });
        });
    </script>

    <!-- Custom Audio Player Script with Visualization -->
    <script>
        const tracks = [
            { title: "Luv & Experience", artist: "James Hou • Nujabes Beat", src: "assets/music/Luv & Experience on Nujabes beat.mp3" }
        ];

        let currentTrackIndex = 0;
        let isPlaying = false;
        let animationId = null;

        // Create Audio element for actual playback
        const audio = new Audio();
        audio.src = tracks[currentTrackIndex].src;

        // Canvas setup for visualization
        const canvas = document.getElementById('audioVisualizer');
        const ctx = canvas.getContext('2d');

        // DOM Elements
        const titleEl = document.querySelector('.song-title');
        const artistEl = document.querySelector('.artist-name');
        const playBtnEl = document.getElementById('playBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const timeDisplay = document.getElementById('timeDisplay');
        const progressContainer = document.querySelector('.progress-container');
        const progressBar = document.querySelector('.progress-bar');

        // Resize canvas to match container
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // ======================================
        // Stripe-Style Gradient Mesh Flow Visualization
        // ======================================
        let animTime = 0;

        const gradientBlobs = [
            { x: 0.3, y: 0.3, size: 0.6, color: [0, 255, 255], speed: 0.004, phase: 0 },
            { x: 0.7, y: 0.6, size: 0.5, color: [255, 0, 255], speed: 0.006, phase: 2 },
            { x: 0.5, y: 0.8, size: 0.55, color: [139, 92, 246], speed: 0.005, phase: 4 },
            { x: 0.2, y: 0.6, size: 0.45, color: [59, 130, 246], speed: 0.007, phase: 1 },
            { x: 0.8, y: 0.2, size: 0.4, color: [0, 255, 102], speed: 0.0045, phase: 3 }
        ];

        function drawGradientMesh() {
            if (!isPlaying) return;

            animTime += 1;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            gradientBlobs.forEach((blob, i) => {
                const offsetX = Math.sin(animTime * blob.speed + blob.phase) * 0.25;
                const offsetY = Math.cos(animTime * blob.speed * 0.8 + blob.phase) * 0.2;

                const centerX = (blob.x + offsetX) * canvas.width;
                const centerY = (blob.y + offsetY) * canvas.height;
                const radius = blob.size * Math.max(canvas.width, canvas.height);

                const pulse = 1 + Math.sin(animTime * 0.008 + i) * 0.15;
                const finalRadius = radius * pulse;

                const gradient = ctx.createRadialGradient(
                    centerX, centerY, 0,
                    centerX, centerY, finalRadius
                );

                const [r, g, b] = blob.color;
                gradient.addColorStop(0, `rgba(${r}, ${g}, ${b}, 0.35)`);
                gradient.addColorStop(0.4, `rgba(${r}, ${g}, ${b}, 0.2)`);
                gradient.addColorStop(0.7, `rgba(${r}, ${g}, ${b}, 0.08)`);
                gradient.addColorStop(1, `rgba(${r}, ${g}, ${b}, 0)`);

                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            });

            drawNoiseOverlay();
            animationId = requestAnimationFrame(drawGradientMesh);
        }

        function drawNoiseOverlay() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            for (let i = 0; i < data.length; i += 4) {
                const noise = (Math.random() - 0.5) * 5;
                data[i] = Math.max(0, Math.min(255, data[i] + noise));
                data[i + 1] = Math.max(0, Math.min(255, data[i + 1] + noise));
                data[i + 2] = Math.max(0, Math.min(255, data[i + 2] + noise));
            }

            ctx.putImageData(imageData, 0, 0);
        }

        // ======================================
        // Audio Playback Controls
        // ======================================
        const playlistContainer = document.getElementById('playlistItems');

        // Format time as M:SS
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Update progress bar and time display
        audio.addEventListener('timeupdate', () => {
            if (audio.duration) {
                const progress = (audio.currentTime / audio.duration) * 100;
                progressBar.style.width = `${progress}%`;
                timeDisplay.textContent = formatTime(audio.currentTime);
            }
        });

        // Handle track ending
        audio.addEventListener('ended', () => {
            // Move to next track or stop if only one track
            if (tracks.length > 1) {
                currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
                loadTrack(currentTrackIndex);
                renderPlaylist();
                audio.play();
            } else {
                // Reset to beginning for single track
                audio.currentTime = 0;
                stopPlayback();
            }
        });

        // Click on progress bar to seek
        progressContainer.addEventListener('click', (e) => {
            const rect = progressContainer.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const percentage = clickX / rect.width;
            audio.currentTime = percentage * audio.duration;
        });

        // Render Playlist
        function renderPlaylist() {
            playlistContainer.innerHTML = '';
            tracks.forEach((track, index) => {
                const li = document.createElement('li');
                li.className = `playlist-item ${index === currentTrackIndex ? 'active' : ''}`;
                li.innerHTML = `
                    <span class="track-number">${index + 1}</span>
                    <div class="track-info">
                        <span class="track-name">${track.title}</span>
                        <span class="track-artist">${track.artist.split('•')[0].trim()}</span>
                    </div>
                `;
                li.addEventListener('click', () => {
                    selectTrack(index);
                });
                playlistContainer.appendChild(li);
            });
        }

        function selectTrack(index) {
            currentTrackIndex = index;
            loadTrack(currentTrackIndex);
            renderPlaylist();
            startPlayback();
        }

        function loadTrack(index) {
            titleEl.textContent = tracks[index].title;
            artistEl.textContent = tracks[index].artist;
            audio.src = tracks[index].src;
            timeDisplay.textContent = "0:00";
            progressBar.style.width = '0%';
        }

        function startPlayback() {
            audio.play().then(() => {
                isPlaying = true;
                canvas.classList.add('active');
                playBtnEl.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" fill="black"/></svg>';
                animTime = 0;
                drawGradientMesh();
            }).catch(err => {
                console.error('Playback failed:', err);
            });
        }

        function stopPlayback() {
            audio.pause();
            isPlaying = false;
            canvas.classList.remove('active');
            playBtnEl.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5V19L19 12L8 5Z" fill="black"/></svg>';
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
        }

        // Initial Load
        renderPlaylist();
        loadTrack(currentTrackIndex);

        // Play/Pause button
        playBtnEl.addEventListener('click', () => {
            if (isPlaying) {
                stopPlayback();
            } else {
                startPlayback();
            }
        });

        // Next button
        nextBtn.addEventListener('click', () => {
            currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
            loadTrack(currentTrackIndex);
            renderPlaylist();
            if (isPlaying) {
                audio.play();
                animTime = 0;
            }
        });

        // Previous button
        prevBtn.addEventListener('click', () => {
            currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
            loadTrack(currentTrackIndex);
            renderPlaylist();
            if (isPlaying) {
                audio.play();
                animTime = 0;
            }
        });
    </script>
</body>

</html>